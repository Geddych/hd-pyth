<!DOCTYPE html>
{% load static %}

<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{% static './css/app.css' %}">
    <link rel="stylesheet" href="{% static './css/foundation.css' %}">
    
    <title>Document</title>
</head>
<body>
    <header class="grid-x grid-padding-x grid-padding-y">
        <h3 class="cell small-8">
            Name
        </h3>
        <div class="button-group no-gaps">
            <button class="button dropdown" type="button" data-toggle="dd-create">Работа с формами</button>
            <button class="button dropdown" type="button" data-toggle="dd-report">Отчеты</button>   
        </div>

        <div class="dropdown-pane" id="dd-report" data-dropdown >
            <button class="button clear" data-open="all-tec">Вся техника</button>
            <button class="button clear" data-open="all-dep">Все отделения</button>
            <button class="button clear" data-open="w-off">Списанная техника</button>
            <button class="button clear" data-open="t-ret">Выданная техника</button>
        </div>
        <div class="dropdown-pane" id="dd-create" data-dropdown>
            {% if tecs %}
            <a class="button clear" href = '/add_rec'>Новая отправка</a>
            {% else %}
            <a class="button clear" href="/add_rec" disabled>Новая отправка</a>
            {% endif %}
            <a class="button clear" href="/add_tec">Новая техника</a>
            <a class="button clear" href="/add_dep">Новое отделение</a>
        </div>
        
    </header>
    <main class="">
        {% if SRs %}
        <table>
            <thead>
                <tr>
                    <th>
                        Наименование
                    </th>
                    <th>
                        Отделение
                    </th>
                    <th>
                        Дата получения
                    </th>
                    <th>
                        Дата отправки
                    </th>
                    <th>
                        Дата прибытия
                    </th>
                    <th>
                        Причина отправки
                    </th>
                    <th>
                        Управление
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for sr in SRs %}
                <tr>
                    <td>{{ sr.technics.name }}</td>
                    <td>{{ sr.depart.short_name }}</td>
                    <td> {{ sr.get_date }} </td>
                    <td> {{sr.send_date}} </td>
                    <td>
                         {{ sr.retus_date}}
                    </td>
                    {% if repair_reason == None %}
                        <td> Заправка </td>
                    {% else %}
                        <td> {{sr.repair_reason}} </td>
                    {% endif %}
                    
                    <td>
                        <div class="button-group no-gaps">
                        {% if sr.send_date == None %}
                            <a href="send/{{ sr.id }}" class="button success">
                                Отправить
                            </a>
                            <a class="button secondary" href="rec/{{ sr.id }}">
                                Редактировать
                            </a>
                        {% else %}
                        {% if sr.retus_date == None %}
                        <a class="button success" href="conf/{{sr.id}}">
                            Принять
                        </a>
                        {% else %}
                        <a class="button success" href="return/{{sr.id}}">
                            Выдать
                        </a>
                        <a class="button alert" href="writeoff/{{ sr.id }}">
                            Списать
                        </a>
                        {% endif %}
                        
                        {% endif%}
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <h3>
            Техники на отправку нет
        </h3>
        {% endif %}
    </main>

    <div class="reveal" id="all-tec" data-reveal> <!-- Модалка для техники -->
        <table>
            <thead>
                <tr>
                    <th>
                        Название
                    </th>
                    <th>
                        Тип техники
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for tec in tecs %}
                <tr>
                    <td>
                        {{ tec.name }}
                    </td>
                    <td>
                        {{ tec.t_type }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="reveal" id="all-dep" data-reveal>  <!-- Модалка для отделений-->
        <table>
            <thead>
                <tr>
                    <th>
                        Название
                    </th>
                    <th>
                        Сокращение
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for dep in deps %}
                <tr>
                    <td>
                        {{ dep.name }}
                    </td>
                    <td>
                        {{ dep.short_name }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="reveal" id="w-off" data-reveal> <!-- Модалка для списанных -->
        <div class="grid-container">
            {% if woff %}
        <table>
            <thead>
                <tr>
                    <th>
                        Техника
                    </th>
                    <th>
                        Отдел
                    </th>
                    <th>
                        Дата списания
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for w in woff %}
                <tr>
                    <td>
                        {{ w.name }}
                    </td>
                    <td>
                        {{ w.depart }}
                    </td>
                    <td>
                        {{ w.date_woff }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <a href="#" class="button">Получить в Excel</a>
        {% else %}
            <h2>
                Списанной техники нет
            </h2>
        {% endif %}
        </div>
    </div>

    <div class="reveal" id="t-ret" data-reveal> <!-- Модалка для списанных -->
        <div class="grid-container">
            {% if woff %}
        <table>
            <thead>
                <tr>
                    <th>
                        Техника
                    </th>
                    <th>
                        Отдел
                    </th>
                    <th>
                        Дата получения
                    </th>
                    <th>
                        Дата возврата
                    </th>
                </tr>
            </thead>
            <tbody>
                {% for t in rtec %}
                <tr>
                    <td>
                        {{ t.technics }}
                    </td>
                    <td>
                        {{ t.depart.short_name }}
                    </td>
                    <td>
                        {{ t.get_date}}
                    </td>
                    <td>
                        {{ t.ret_date }}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <a href="#" class="button">Получить в Excel</a>
        {% else %}
            <h2>
                Списанной техники нет
            </h2>
        {% endif %}
        </div>
    </div>

<script src="{% static 'js/vendor/jquery.js'%}"></script>
<script src="{% static 'js/vendor/what-input.js'%}"></script>
<script src="{% static 'js/vendor/foundation.js'%}"></script>
<script src="{% static 'js/app.js'%}"></script>


</body>
</html>